<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Subject Configuration - {{ school_name }}</title>

    <!-- Heroicons - Premium SVG Icons (No external dependencies, guaranteed display) -->
    <style>
      /* Heroicons SVG Icon Base Styles */
      .heroicon {
        display: inline-block;
        width: 1.25rem;
        height: 1.25rem;
        fill: currentColor;
        vertical-align: middle;
      }

      .heroicon-lg {
        width: 1.8rem;
        height: 1.8rem;
      }

      .heroicon-xl {
        width: 2.5rem;
        height: 2.5rem;
      }

      /* Solar Theme Heroicon Colors */
      .heroicon-solar-yellow {
        fill: #b58900;
      }
      .heroicon-solar-blue {
        fill: #268bd2;
      }
      .heroicon-solar-green {
        fill: #859900;
      }
      .heroicon-solar-red {
        fill: #dc322f;
      }
    </style>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- SOLAR THEME OVERRIDES - MUST COME AFTER BOOTSTRAP -->
    <style>
      /* FORCE SOLAR THEME BACKGROUND - HIGHEST PRIORITY */
      html {
        background: linear-gradient(
          135deg,
          #fdf6e3 0%,
          #eee8d5 50%,
          #d6d2c4 100%
        ) !important;
        min-height: 100vh !important;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background: linear-gradient(
          135deg,
          #fdf6e3 0%,
          #eee8d5 50%,
          #d6d2c4 100%
        ) !important;
        min-height: 100vh !important;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif !important;
        padding: 20px !important;
        margin: 0 !important;
        overflow-x: hidden !important;
        background-attachment: fixed !important;
      }

      /* Override any Bootstrap or external CSS backgrounds */
      body,
      html,
      .container,
      .container-fluid,
      .container-lg,
      .container-md,
      .container-sm,
      .container-xl,
      .container-xxl {
        background: linear-gradient(
          135deg,
          #fdf6e3 0%,
          #eee8d5 50%,
          #d6d2c4 100%
        ) !important;
      }

      /* Force Solar background on all possible containers */
      div,
      main,
      section,
      article {
        background: transparent !important;
      }

      .config-container {
        background: linear-gradient(
          145deg,
          rgba(253, 246, 227, 0.95) 0%,
          rgba(238, 232, 213, 0.9) 100%
        );
        backdrop-filter: blur(15px);
        border-radius: 25px;
        box-shadow: 0 20px 40px rgba(0, 43, 54, 0.15);
        border: 2px solid rgba(181, 137, 0, 0.2);
        max-width: 1400px;
        margin: 0 auto;
        padding: 40px;
      }

      .config-header {
        text-align: center;
        margin-bottom: 40px;
        color: #002b36;
      }

      .config-header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 10px;
        background: linear-gradient(135deg, #b58900, #268bd2);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .config-header .lead {
        font-size: 1.1rem;
        color: #586e75;
        font-weight: 400;
      }

      /* Flexbox Grid Layout */
      .config-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 25px;
        justify-content: center;
        margin-bottom: 40px;
      }

      .config-card {
        background: linear-gradient(
          145deg,
          rgba(253, 246, 227, 0.95) 0%,
          rgba(238, 232, 213, 0.9) 100%
        );
        border-radius: 20px;
        padding: 30px;
        border: 2px solid rgba(181, 137, 0, 0.3);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 8px 25px rgba(0, 43, 54, 0.1);
        flex: 1 1 400px;
        max-width: 450px;
        min-height: 320px;
        display: flex;
        flex-direction: column;
        position: relative;
        overflow: hidden;
      }

      .config-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #b58900, #268bd2);
        border-radius: 20px 20px 0 0;
      }

      .config-card:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 20px 40px rgba(0, 43, 54, 0.2);
        border-color: rgba(181, 137, 0, 0.6);
      }

      /* Card Header Styling */
      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 2px solid rgba(181, 137, 0, 0.2);
      }

      .subject-name {
        font-size: 1.5rem;
        font-weight: 700;
        color: #002b36;
        text-transform: capitalize;
        margin: 0;
      }

      .education-level-badge {
        background: linear-gradient(135deg, #b58900, #859900);
        color: white;
        padding: 8px 16px;
        border-radius: 25px;
        font-size: 0.85rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        box-shadow: 0 4px 15px rgba(181, 137, 0, 0.3);
      }

      /* Toggle Section */
      .toggle-section {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        padding: 20px;
        background: rgba(181, 137, 0, 0.08);
        border-radius: 15px;
        border: 1px solid rgba(181, 137, 0, 0.2);
      }

      .toggle-label {
        font-size: 1.1rem;
        font-weight: 600;
        color: #073642;
      }

      .toggle-controls {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .status-badge {
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .status-composite {
        background: linear-gradient(135deg, #859900, #b58900);
        color: white;
        box-shadow: 0 4px 15px rgba(133, 153, 0, 0.3);
      }

      .status-simple {
        background: linear-gradient(135deg, #dc322f, #cb4b16);
        color: white;
        box-shadow: 0 4px 15px rgba(220, 50, 47, 0.3);
      }

      /* Modern Toggle Switch */
      .toggle-switch {
        position: relative;
        display: inline-block;
        width: 70px;
        height: 38px;
      }

      .toggle-switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, #93a1a1, #839496);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        border-radius: 38px;
        box-shadow: inset 0 2px 4px rgba(0, 43, 54, 0.1);
      }

      .slider:before {
        position: absolute;
        content: "";
        height: 30px;
        width: 30px;
        left: 4px;
        bottom: 4px;
        background: linear-gradient(135deg, #fdf6e3, #eee8d5);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        border-radius: 50%;
        box-shadow: 0 4px 8px rgba(0, 43, 54, 0.2);
      }

      input:checked + .slider {
        background: linear-gradient(135deg, #b58900, #268bd2);
        box-shadow: 0 0 20px rgba(181, 137, 0, 0.4);
      }

      input:checked + .slider:before {
        transform: translateX(32px);
        box-shadow: 0 4px 12px rgba(0, 43, 54, 0.3);
      }

      /* Component Information */
      .component-info {
        background: linear-gradient(
          135deg,
          rgba(133, 153, 0, 0.08),
          rgba(181, 137, 0, 0.08)
        );
        border-radius: 15px;
        padding: 20px;
        margin-top: 20px;
        border: 1px solid rgba(133, 153, 0, 0.2);
        backdrop-filter: blur(10px);
      }

      .info-text {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        font-size: 0.95rem;
        color: #586e75;
        line-height: 1.5;
      }

      .info-text i {
        color: #859900;
        margin-top: 2px;
        font-size: 1.1rem;
      }

      .info-text strong {
        color: #198754;
        font-weight: 600;
      }

      /* Action Buttons */
      .action-buttons {
        text-align: center;
        margin-top: 30px;
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
      }

      .btn-primary {
        background: linear-gradient(135deg, #b58900, #859900);
        border: none;
        border-radius: 25px;
        padding: 15px 30px;
        font-weight: 600;
        font-size: 1rem;
        color: white;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 8px 25px rgba(181, 137, 0, 0.3);
      }

      .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 35px rgba(181, 137, 0, 0.4);
        color: white;
        background: linear-gradient(135deg, #859900, #b58900);
      }

      .btn-secondary {
        background: linear-gradient(135deg, #586e75, #073642);
        border: none;
        border-radius: 25px;
        padding: 15px 30px;
        font-weight: 600;
        font-size: 1rem;
        color: white;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 8px 25px rgba(88, 110, 117, 0.3);
      }

      .btn-secondary:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 35px rgba(88, 110, 117, 0.4);
        color: white;
        background: linear-gradient(135deg, #073642, #002b36);
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .config-container {
          padding: 20px;
          margin: 10px;
        }

        .config-grid {
          gap: 20px;
        }

        .config-card {
          flex: 1 1 100%;
          max-width: none;
        }

        .card-header {
          flex-direction: column;
          gap: 15px;
          text-align: center;
        }

        .toggle-section {
          flex-direction: column;
          gap: 15px;
          text-align: center;
        }

        .component-row {
          flex-direction: column;
          gap: 15px;
        }

        .action-buttons {
          flex-direction: column;
          align-items: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="config-container">
      <div class="config-header">
        <h1>
          <!-- Heroicon: cog-6-tooth (solid) - Settings/Configuration icon -->
          <svg
            class="heroicon heroicon-lg heroicon-solar-yellow"
            fill="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              fill-rule="evenodd"
              d="M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 00-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 00-2.282.819l-.922 1.597a1.875 1.875 0 00.432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 000 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 00-.432 2.385l.922 1.597a1.875 1.875 0 002.282.818l1.019-.382c.115-.043.283-.032.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.570.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 002.28-.819l.923-1.597a1.875 1.875 0 00-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 000-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 00-2.282-.818l-1.02.382c-.114.043-.282.032-.449-.083a7.49 7.49 0 00-.985-.57c-.183-.087-.277-.227-.297-.348L13.928 3.817c-.151-.904-.933-1.567-1.85-1.567h-1.844z"
              clip-rule="evenodd"
            />
            <path
              fill-rule="evenodd"
              d="M12 8.25a3.75 3.75 0 100 7.5 3.75 3.75 0 000-7.5z"
              clip-rule="evenodd"
            />
          </svg>
          Subject Configuration
        </h1>
        <p class="lead">
          Toggle English and Kiswahili between composite and simple modes. Raw
          marks for composite subjects are entered during marks upload.
        </p>
      </div>

      <div class="config-grid">
        {% for config in configurations %}
        <div
          class="config-card"
          data-subject="{{ config.subject_name }}"
          data-level="{{ config.education_level }}"
        >
          <!-- Card Header -->
          <div class="card-header">
            <h3 class="subject-name">{{ config.subject_name }}</h3>
            <span class="education-level-badge">
              {{ config.education_level.replace('_', ' ').title() }}
            </span>
          </div>

          <!-- Toggle Section -->
          <div class="toggle-section">
            <span class="toggle-label">Composite Mode:</span>
            <div class="toggle-controls">
              <span
                class="status-badge {% if config.is_composite %}status-composite{% else %}status-simple{% endif %}"
              >
                {% if config.is_composite %}Composite{% else %}Simple{% endif %}
              </span>
              <label class="toggle-switch">
                <input
                  type="checkbox"
                  {%
                  if
                  config.is_composite
                  %}checked{%
                  endif
                  %}
                  onchange="toggleComposite('{{ config.subject_name }}', '{{ config.education_level }}', this.checked)"
                />
                <span class="slider"></span>
              </label>
            </div>
          </div>

          <!-- Component Information (Read-only) -->
          {% if config.is_composite %}
          <div
            class="component-info"
            id="components-{{ config.subject_name }}-{{ config.education_level }}"
          >
            <div class="info-text">
              <!-- Heroicon: information-circle (solid) - Info icon -->
              <svg
                class="heroicon heroicon-solar-blue"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  fill-rule="evenodd"
                  d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 01.67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 11-.671-1.34l.041-.022zM12 9a.75.75 0 100-1.5.75.75 0 000 1.5z"
                  clip-rule="evenodd"
                />
              </svg>
              <span>
                When composite mode is enabled, this subject will show
                <strong>{{ config.component_1_name }}</strong> and
                <strong>{{ config.component_2_name }}</strong>
                input fields in marks upload for entering raw marks.
              </span>
            </div>
          </div>
          {% endif %}
        </div>
        {% endfor %}
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button id="saveAllBtn" class="btn-primary" type="button">
          <!-- Heroicon: document-check (solid) - Save icon -->
          <svg class="heroicon" fill="currentColor" viewBox="0 0 24 24">
            <path
              fill-rule="evenodd"
              d="M3.75 3.375c0-1.036.84-1.875 1.875-1.875H9.75a.75.75 0 01.75.75v3.75h3.75a.75.75 0 01.75.75v6.75a.75.75 0 01-.75.75h-9a.75.75 0 01-.75-.75V3.375zm6 8.25a.75.75 0 01.75-.75h3a.75.75 0 010 1.5h-3a.75.75 0 01-.75-.75zm.75 2.25a.75.75 0 000 1.5h3a.75.75 0 000-1.5h-3z"
              clip-rule="evenodd"
            />
            <path
              d="M14.25 5.25a5.23 5.23 0 00-1.279-3.434 9.768 9.768 0 016.963 6.963A5.23 5.23 0 0016.5 7.5h-1.875a.375.375 0 01-.375-.375V5.25z"
            />
          </svg>
          Save All Configurations
        </button>

        <a href="{{ url_for('universal.dashboard') }}" class="btn-secondary">
          <!-- Heroicon: arrow-left (solid) - Back arrow icon -->
          <svg class="heroicon" fill="currentColor" viewBox="0 0 24 24">
            <path
              fill-rule="evenodd"
              d="M9.53 2.47a.75.75 0 010 1.06L4.81 8.25H15a6.75 6.75 0 010 13.5H9a.75.75 0 010-1.5h6a5.25 5.25 0 100-10.5H4.81l4.72 4.72a.75.75 0 11-1.06 1.06l-6-6a.75.75 0 010-1.06l6-6a.75.75 0 011.06 0z"
              clip-rule="evenodd"
            />
          </svg>
          Back to Dashboard
        </a>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      // Add event listener when DOM is loaded
      document.addEventListener("DOMContentLoaded", function () {
        console.log("🚀 Subject Configuration page loaded");

        const saveBtn = document.getElementById("saveAllBtn");
        if (saveBtn) {
          console.log("✅ Save button found, adding event listener");
          saveBtn.addEventListener("click", function (e) {
            e.preventDefault();
            console.log("🔄 Save button clicked via event listener");
            saveAllConfigurations();
          });
        } else {
          console.error("❌ Save button not found!");
        }
      });
    </script>
    <script>
      function toggleComposite(subjectName, educationLevel, isComposite) {
        console.log(
          `Toggling ${subjectName} (${educationLevel}) to ${
            isComposite ? "composite" : "simple"
          }`
        );

        // Update UI immediately
        const card = document.querySelector(
          `[data-subject="${subjectName}"][data-level="${educationLevel}"]`
        );
        const statusBadge = card?.querySelector(".status-badge");
        const componentsDiv = document.getElementById(
          `components-${subjectName}-${educationLevel}`
        );

        if (statusBadge) {
          if (isComposite) {
            statusBadge.textContent = "Composite";
            statusBadge.className = "status-badge status-composite me-2";
          } else {
            statusBadge.textContent = "Simple";
            statusBadge.className = "status-badge status-simple me-2";
          }
        }

        // Show/hide component info
        if (componentsDiv) {
          componentsDiv.style.display = isComposite ? "block" : "none";
        }

        // Send update to server
        fetch("/api/subject-config/toggle", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            subject_name: subjectName,
            education_level: educationLevel,
            is_composite: isComposite,
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              showNotification(
                "Configuration updated successfully!",
                "success"
              );
            } else {
              showNotification(
                "Failed to update configuration: " + data.message,
                "error"
              );
            }
          })
          .catch((error) => {
            console.error("Error:", error);
            showNotification("Error updating configuration", "error");
          });
      }

      function saveAllConfigurations() {
        console.log("🔄 Save All Configurations button clicked");

        // Show immediate feedback
        showNotification("Saving all configurations...", "info");

        // Disable button to prevent double-clicks
        const saveBtn = document.getElementById("saveAllBtn");
        if (saveBtn) {
          saveBtn.disabled = true;
          saveBtn.innerHTML =
            '<svg class="heroicon" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.25A.75.75 0 0112.75 3v7.25H20a.75.75 0 010 1.5h-7.25V19a.75.75 0 01-1.5 0v-7.25H4a.75.75 0 010-1.5h7.25V3a.75.75 0 01.75-.75z"/></svg> Saving...';
        }

        // Get CSRF token if available
        const csrfToken = document
          .querySelector("meta[name=csrf-token]")
          ?.getAttribute("content");
        const headers = {
          "Content-Type": "application/json",
        };

        if (csrfToken) {
          headers["X-CSRFToken"] = csrfToken;
          console.log("🔐 CSRF token found and added");
        } else {
          console.log("⚠️ No CSRF token found");
        }

        console.log("📡 Making API request to /api/subject-config/save-all");

        fetch("/api/subject-config/save-all", {
          method: "POST",
          headers: headers,
        })
          .then((response) => {
            console.log(
              "📥 Response received:",
              response.status,
              response.statusText
            );
            if (!response.ok) {
              throw new Error(
                `HTTP ${response.status}: ${response.statusText}`
              );
            }
            return response.json();
          })
          .then((data) => {
            console.log("📊 Response data:", data);
            if (data.success) {
              showNotification(
                data.message ||
                  "✅ Configurations Saved! Composite subjects will now appear in marks upload for entering raw marks based on education level.",
                "success"
              );
            } else {
              showNotification(
                "Failed to save configurations: " + data.message,
                "error"
              );
            }
          })
          .catch((error) => {
            console.error("❌ Error:", error);
            showNotification(
              "Error saving configurations: " + error.message,
              "error"
            );
          })
          .finally(() => {
            // Re-enable button
            const saveBtn = document.getElementById("saveAllBtn");
            if (saveBtn) {
              saveBtn.disabled = false;
              saveBtn.innerHTML =
                '<svg class="heroicon" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M3.75 3.375c0-1.036.84-1.875 1.875-1.875H9.75a.75.75 0 01.75.75v3.75h3.75a.75.75 0 01.75.75v6.75a.75.75 0 01-.75.75h-9a.75.75 0 01-.75-.75V3.375zm6 8.25a.75.75 0 01.75-.75h3a.75.75 0 010 1.5h-3a.75.75 0 01-.75-.75zm.75 2.25a.75.75 0 000 1.5h3a.75.75 0 000-1.5h-3z" clip-rule="evenodd"/><path d="M14.25 5.25a5.23 5.23 0 00-1.279-3.434 9.768 9.768 0 016.963 6.963A5.23 5.23 0 0016.5 7.5h-1.875a.375.375 0 01-.375-.375V5.25z"/></svg> Save All Configurations';
            }
          });
      }

      function showNotification(message, type) {
        // Remove any existing notifications first
        const existingNotifications = document.querySelectorAll(
          ".custom-notification"
        );
        existingNotifications.forEach((n) => n.remove());

        // Create notification with better visibility
        const notification = document.createElement("div");
        notification.className = `custom-notification alert alert-${
          type === "success" ? "success" : type === "error" ? "danger" : "info"
        }`;

        notification.style.cssText = `
          position: fixed;
          top: 10px;
          left: 10px;
          right: 10px;
          z-index: 99999;
          margin: 0 auto;
          max-width: 95%;
          width: auto;
          box-shadow: 0 8px 25px rgba(0,0,0,0.4);
          border-radius: 12px;
          font-size: 16px;
          font-weight: 500;
          padding: 20px 25px;
          border: 2px solid ${
            type === "success"
              ? "#28a745"
              : type === "error"
              ? "#dc3545"
              : "#17a2b8"
          };
          background: ${
            type === "success"
              ? "#d4edda"
              : type === "error"
              ? "#f8d7da"
              : "#d1ecf1"
          };
          color: ${
            type === "success"
              ? "#155724"
              : type === "error"
              ? "#721c24"
              : "#0c5460"
          };
          animation: slideDownBounce 0.5s ease-out;
          text-align: left;
          line-height: 1.5;
        `;

        // Add enhanced CSS animations
        if (!document.getElementById("enhanced-notification-styles")) {
          const style = document.createElement("style");
          style.id = "enhanced-notification-styles";
          style.textContent = `
            @keyframes slideDownBounce {
              0% {
                transform: translateY(-100%);
                opacity: 0;
              }
              60% {
                transform: translateY(10px);
                opacity: 1;
              }
              100% {
                transform: translateY(0);
                opacity: 1;
              }
            }
            @keyframes slideUpFade {
              0% {
                transform: translateY(0);
                opacity: 1;
              }
              100% {
                transform: translateY(-100%);
                opacity: 0;
              }
            }
            .custom-notification .close-btn {
              background: none;
              border: none;
              font-size: 28px;
              font-weight: bold;
              color: inherit;
              cursor: pointer;
              padding: 0;
              margin-left: 15px;
              opacity: 0.7;
              transition: opacity 0.2s;
              line-height: 1;
            }
            .custom-notification .close-btn:hover {
              opacity: 1;
              transform: scale(1.1);
            }
          `;
          document.head.appendChild(style);
        }

        notification.innerHTML = `
          <div style="display: flex; align-items: flex-start; gap: 15px; width: 100%;">
            ${
              type === "success"
                ? '<svg class="heroicon-lg heroicon-solar-green" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd"/></svg>'
                : type === "error"
                ? '<svg class="heroicon-lg heroicon-solar-red" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z" clip-rule="evenodd"/></svg>'
                : '<svg class="heroicon-lg heroicon-solar-blue" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 01.67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 11-.671-1.34l.041-.022zM12 9a.75.75 0 100-1.5.75.75 0 000 1.5z" clip-rule="evenodd"/></svg>'
            }
            <div style="flex: 1; word-wrap: break-word; overflow-wrap: break-word;">
              ${message}
            </div>
            <button type="button" class="close-btn" onclick="closeNotification(this)" title="Click to close">
              ×
            </button>
          </div>
        `;

        document.body.appendChild(notification);

        // NO auto-remove - user must click X to close
        // This ensures they can read the full message
      }

      function closeNotification(button) {
        const notification = button.closest(".custom-notification");
        if (notification) {
          notification.style.animation = "slideUpFade 0.3s ease-in forwards";
          setTimeout(() => {
            if (notification.parentElement) {
              notification.remove();
            }
          }, 300);
        }
      }
    </script>
  </body>
</html>
