<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Configuration - {{ config.school_name if config.school_name != 'School Name' else 'School Management System' }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .config-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .config-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 1px solid #e9ecef;
            border-radius: 8px;
        }
        
        .config-section h3 {
            color: var(--color-forest-green);
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--color-bright-green);
            padding-bottom: 0.5rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--color-text-dark);
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: auto;
        }
        
        .color-input {
            width: 60px !important;
            height: 40px;
            padding: 0;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .btn-save {
            background: var(--color-bright-green);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .btn-save:hover {
            background: var(--color-forest-green);
        }
        
        .alert {
            padding: 1rem;
            border-radius: 6px;
            margin-bottom: 1rem;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="config-container">
        <h1>School Configuration</h1>
        <p>Configure your school's information and system settings.</p>
        
        {% if success_message %}
            <div class="alert alert-success">{{ success_message }}</div>
        {% endif %}
        
        {% if error_message %}
            <div class="alert alert-error">{{ error_message }}</div>
        {% endif %}
        
        <form method="POST" enctype="multipart/form-data">
            <!-- School Identity Section -->
            <div class="config-section">
                <h3>School Information</h3>
                
                <div class="form-group">
                    <label for="school_name">School Name *</label>
                    <input type="text" id="school_name" name="school_name" 
                           value="{{ config.school_name }}" required>
                </div>
                
                <div class="form-group">
                    <label for="school_motto">School Motto</label>
                    <input type="text" id="school_motto" name="school_motto" 
                           value="{{ config.school_motto or '' }}">
                </div>
                
                <div class="form-group">
                    <label for="school_address">School Address</label>
                    <textarea id="school_address" name="school_address">{{ config.school_address or '' }}</textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="school_phone">Phone Number</label>
                        <input type="tel" id="school_phone" name="school_phone" 
                               value="{{ config.school_phone or '' }}">
                    </div>
                    
                    <div class="form-group">
                        <label for="school_email">Email Address</label>
                        <input type="email" id="school_email" name="school_email" 
                               value="{{ config.school_email or '' }}">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="school_website">Website</label>
                    <input type="url" id="school_website" name="school_website" 
                           value="{{ config.school_website or '' }}">
                </div>
                
                <div class="form-group">
                    <label for="logo_file">School Logo</label>
                    <input type="file" id="logo_file" name="logo_file" accept="image/*">
                    {% if config.logo_filename %}
                        <small>Current logo: {{ config.logo_filename }}</small>
                    {% endif %}
                </div>
            </div>
            
            <!-- Academic Configuration Section -->
            <div class="config-section">
                <h3>Academic Settings</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="current_academic_year">Current Academic Year *</label>
                        <input type="text" id="current_academic_year" name="current_academic_year" 
                               value="{{ config.current_academic_year }}" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="current_term">Current Term *</label>
                        <input type="text" id="current_term" name="current_term" 
                               value="{{ config.current_term }}" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="grading_system">Grading System</label>
                        <select id="grading_system" name="grading_system">
                            <option value="CBC" {{ 'selected' if config.grading_system == 'CBC' else '' }}>CBC</option>
                            <option value="8-4-4" {{ 'selected' if config.grading_system == '8-4-4' else '' }}>8-4-4</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="max_raw_marks_default">Default Maximum Marks</label>
                        <input type="number" id="max_raw_marks_default" name="max_raw_marks_default" 
                               value="{{ config.max_raw_marks_default }}" min="1" max="1000">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="pass_mark_percentage">Pass Mark Percentage</label>
                    <input type="number" id="pass_mark_percentage" name="pass_mark_percentage" 
                           value="{{ config.pass_mark_percentage }}" min="0" max="100" step="0.1">
                </div>
            </div>
            
            <!-- Staff Information Section -->
            <div class="config-section">
                <h3>Staff Information</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="headteacher_name">Headteacher Name</label>
                        <input type="text" id="headteacher_name" name="headteacher_name" 
                               value="{{ config.headteacher_name or '' }}">
                    </div>
                    
                    <div class="form-group">
                        <label for="deputy_headteacher_name">Deputy Headteacher Name</label>
                        <input type="text" id="deputy_headteacher_name" name="deputy_headteacher_name" 
                               value="{{ config.deputy_headteacher_name or '' }}">
                    </div>
                </div>
            </div>
            
            <!-- System Configuration Section -->
            <div class="config-section">
                <h3>System Settings</h3>
                
                <div class="form-group checkbox-group">
                    <input type="checkbox" id="use_streams" name="use_streams" 
                           {{ 'checked' if config.use_streams else '' }}>
                    <label for="use_streams">Use Streams/Classes (uncheck if school has only one class per grade)</label>
                </div>
                
                <div class="form-group checkbox-group">
                    <input type="checkbox" id="show_position" name="show_position" 
                           {{ 'checked' if config.show_position else '' }}>
                    <label for="show_position">Show student position in reports</label>
                </div>
                
                <div class="form-group checkbox-group">
                    <input type="checkbox" id="show_class_average" name="show_class_average" 
                           {{ 'checked' if config.show_class_average else '' }}>
                    <label for="show_class_average">Show class average in reports</label>
                </div>
                
                <div class="form-group checkbox-group">
                    <input type="checkbox" id="show_subject_teacher" name="show_subject_teacher" 
                           {{ 'checked' if config.show_subject_teacher else '' }}>
                    <label for="show_subject_teacher">Show subject teacher in reports</label>
                </div>
            </div>
            
            <!-- Branding Section -->
            <div class="config-section">
                <h3>Branding & Colors</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="primary_color">Primary Color</label>
                        <input type="color" id="primary_color" name="primary_color" 
                               value="{{ config.primary_color }}" class="color-input">
                    </div>
                    
                    <div class="form-group">
                        <label for="secondary_color">Secondary Color</label>
                        <input type="color" id="secondary_color" name="secondary_color" 
                               value="{{ config.secondary_color }}" class="color-input">
                    </div>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 2rem;">
                <button type="submit" class="btn-save">Save Configuration</button>
                <a href="{{ url_for('admin.dashboard') }}" style="margin-left: 1rem; color: var(--color-forest-green);">Back to Dashboard</a>
            </div>
        </form>
    </div>
</body>
</html>
