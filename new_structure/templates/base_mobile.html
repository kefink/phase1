<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <!-- Meta charset set -->
    <meta charset="utf-8" />
    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <!-- Page Title -->
    <title>
      {% block title %}{{ school_info.school_name|default('Hillview School') }}
      Management System{% endblock %}
    </title>

    <!-- Meta Description -->
    <meta
      name="description"
      content="{% block description %}{{ school_info.school_name|default('Hillview School') }} Management System - Mobile-first responsive design{% endblock %}"
    />
    <meta
      name="keywords"
      content="school management, education, mobile responsive, teachers, students"
    />
    <meta
      name="author"
      content="{{ school_info.school_name|default('Hillview School') }}"
    />

    <!-- Mobile Specific Meta -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=5.0, user-scalable=yes"
    />
    <meta name="format-detection" content="telephone=no" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="theme-color" content="#b58900" />
    <meta name="msapplication-TileColor" content="#b58900" />

    <!-- PWA Manifest -->
    <link
      rel="manifest"
      href="{{ url_for('static', filename='manifest.json') }}"
    />

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/x-icon"
      href="{{ url_for('static', filename='images/default_logo.png') }}"
    />
    <link
      rel="apple-touch-icon"
      href="{{ url_for('static', filename='images/default_logo.png') }}"
    />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome Icons -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />

    <!-- Bootswatch Solar Theme - Main Theme -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='bootstrap.min.css') }}"
    />

    <!-- Mobile Solar Theme Enhancements -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/mobile_solar_theme.css') }}"
    />

    <!-- Custom Mobile-First CSS -->
    <style>
      /* Mobile-First Base Styles inspired by brandi-bootstrap-main */
      :root {
        /* Bootswatch Solar Theme Colors */
        --bs-primary: #b58900;
        --bs-secondary: #839496;
        --bs-success: #2aa198;
        --bs-info: #268bd2;
        --bs-warning: #cb4b16;
        --bs-danger: #d33682;
        --bs-light: #fdf6e3;
        --bs-dark: #073642;

        /* Mobile-optimized spacing */
        --mobile-padding: 1rem;
        --mobile-margin: 0.75rem;
        --touch-target: 44px;

        /* Typography scale for mobile */
        --mobile-h1: 1.75rem;
        --mobile-h2: 1.5rem;
        --mobile-h3: 1.25rem;
        --mobile-body: 1rem;
        --mobile-small: 0.875rem;
      }

      /* Reset and base mobile styles */
      * {
        box-sizing: border-box;
      }

      html {
        font-size: 16px;
        -webkit-text-size-adjust: 100%;
        -webkit-tap-highlight-color: transparent;
      }

      body {
        font-family: "Source Sans Pro", -apple-system, BlinkMacSystemFont,
          "Segoe UI", Roboto, sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 0;
        background-color: var(--bs-body-bg);
        color: var(--bs-body-color);
        overflow-x: hidden;
      }

      /* Mobile-first container */
      .mobile-container {
        width: 100%;
        padding: 0 var(--mobile-padding);
        margin: 0 auto;
      }

      /* Mobile navigation inspired by brandi-bootstrap */
      .mobile-navbar {
        background: var(--bs-dark);
        padding: 0.75rem 0;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1050;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .navbar-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 var(--mobile-padding);
      }

      .navbar-brand {
        display: flex;
        align-items: center;
        color: var(--bs-light) !important;
        text-decoration: none;
        font-weight: 600;
        font-size: 1.1rem;
      }

      .navbar-brand img {
        height: 32px;
        width: 32px;
        margin-right: 0.5rem;
        border-radius: 4px;
      }

      /* Mobile menu toggle */
      .navbar-toggle {
        background: none;
        border: none;
        color: var(--bs-light);
        font-size: 1.5rem;
        padding: 0.5rem;
        cursor: pointer;
        min-height: var(--touch-target);
        min-width: var(--touch-target);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      /* Mobile navigation menu */
      .mobile-nav {
        position: fixed;
        top: 0;
        left: -100%;
        width: 280px;
        height: 100vh;
        background: var(--bs-dark);
        transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 1060;
        overflow-y: auto;
        padding-top: 4rem;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
      }

      .mobile-nav.active {
        left: 0;
      }

      /* Enhanced mobile nav animations */
      .mobile-nav-item {
        transform: translateX(-20px);
        opacity: 0;
        transition: all 0.3s ease;
      }

      .mobile-nav.active .mobile-nav-item {
        transform: translateX(0);
        opacity: 1;
      }

      .mobile-nav.active .mobile-nav-item:nth-child(1) {
        transition-delay: 0.1s;
      }
      .mobile-nav.active .mobile-nav-item:nth-child(2) {
        transition-delay: 0.15s;
      }
      .mobile-nav.active .mobile-nav-item:nth-child(3) {
        transition-delay: 0.2s;
      }
      .mobile-nav.active .mobile-nav-item:nth-child(4) {
        transition-delay: 0.25s;
      }
      .mobile-nav.active .mobile-nav-item:nth-child(5) {
        transition-delay: 0.3s;
      }

      .mobile-nav-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1055;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .mobile-nav-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .mobile-nav-header {
        padding: 1rem var(--mobile-padding);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .mobile-nav-close {
        background: none;
        border: none;
        color: var(--bs-light);
        font-size: 1.5rem;
        cursor: pointer;
        padding: 0.5rem;
      }

      .mobile-nav-menu {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .mobile-nav-item {
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .mobile-nav-link {
        display: flex;
        align-items: center;
        padding: 1rem var(--mobile-padding);
        color: var(--bs-light);
        text-decoration: none;
        transition: background-color 0.2s ease;
        min-height: var(--touch-target);
      }

      .mobile-nav-link:hover,
      .mobile-nav-link.active {
        background-color: var(--bs-primary);
        color: var(--bs-light);
      }

      .mobile-nav-link i {
        margin-right: 0.75rem;
        width: 20px;
        text-align: center;
      }

      /* Main content area */
      .main-content {
        margin-top: 4rem;
        min-height: calc(100vh - 4rem);
        padding: var(--mobile-padding) 0;
      }

      /* Page header */
      .page-header {
        background: linear-gradient(
          135deg,
          var(--bs-primary) 0%,
          var(--bs-info) 100%
        );
        color: var(--bs-light);
        padding: 2rem var(--mobile-padding);
        margin-bottom: var(--mobile-margin);
        text-align: center;
      }

      .page-title {
        font-size: var(--mobile-h1);
        font-weight: 700;
        margin: 0 0 0.5rem 0;
      }

      .page-subtitle {
        font-size: var(--mobile-body);
        opacity: 0.9;
        margin: 0;
      }

      /* Mobile-first responsive breakpoints inspired by brandi-bootstrap-main */

      /* Mobile Portrait (320px and up) - Base styles already defined above */

      /* Mobile Landscape (480px and up) */
      @media only screen and (min-width: 480px) {
        .mobile-container {
          padding: 0 1.5rem;
        }

        .page-header {
          padding: 2.5rem 1.5rem;
        }

        .page-title {
          font-size: 2rem;
        }

        .navbar-brand {
          font-size: 1.2rem;
        }

        .mobile-nav {
          width: 320px;
        }
      }

      /* Tablet Portrait (768px and up) */
      @media (min-width: 768px) {
        :root {
          --mobile-padding: 2rem;
          --mobile-margin: 1.5rem;
        }

        .mobile-container {
          max-width: 720px;
          padding: 0 var(--mobile-padding);
        }

        .page-header {
          padding: 3rem var(--mobile-padding);
          text-align: left;
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .page-title {
          font-size: 2.5rem;
        }

        .page-subtitle {
          font-size: 1.1rem;
        }

        /* Hide mobile menu toggle on tablet+ */
        .navbar-toggle {
          display: none;
        }

        /* Show horizontal navigation on tablet+ */
        .mobile-nav {
          position: static;
          width: auto;
          height: auto;
          background: transparent;
          padding-top: 0;
          display: flex;
          align-items: center;
        }

        .mobile-nav-header {
          display: none;
        }

        .mobile-nav-menu {
          display: flex;
          align-items: center;
          gap: 1rem;
        }

        .mobile-nav-item {
          border-bottom: none;
        }

        .mobile-nav-link {
          padding: 0.5rem 1rem;
          border-radius: 0.375rem;
          transition: all 0.2s ease;
        }

        .mobile-nav-link:hover {
          background-color: rgba(255, 255, 255, 0.1);
        }
      }

      /* Tablet Landscape / Small Desktop (992px and up) */
      @media (min-width: 992px) {
        .mobile-container {
          max-width: 960px;
        }

        .page-header {
          padding: 4rem var(--mobile-padding);
        }

        .page-title {
          font-size: 3rem;
        }

        .navbar-brand {
          font-size: 1.3rem;
        }

        .mobile-nav-menu {
          gap: 1.5rem;
        }
      }

      /* Desktop (1200px and up) */
      @media (min-width: 1200px) {
        .mobile-container {
          max-width: 1140px;
        }

        .page-header {
          padding: 5rem var(--mobile-padding);
        }

        .page-title {
          font-size: 3.5rem;
        }
      }

      /* Large Desktop (1400px and up) */
      @media (min-width: 1400px) {
        .mobile-container {
          max-width: 1320px;
        }
      }

      /* Touch-friendly enhancements */
      @media (hover: none) and (pointer: coarse) {
        .mobile-nav-link,
        .navbar-toggle,
        .btn {
          min-height: var(--touch-target);
          min-width: var(--touch-target);
        }

        /* Larger touch targets for mobile */
        .btn {
          padding: 0.75rem 1.5rem;
          font-size: 1.1rem;
        }
      }

      /* Reduced motion preferences */
      @media (prefers-reduced-motion: reduce) {
        * {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }
    </style>

    <!-- Page-specific CSS -->
    {% block extra_css %}{% endblock %}
  </head>

  <body id="body">
    <!-- Mobile Navigation -->
    <nav class="mobile-navbar">
      <div class="navbar-container">
        <a href="{% block home_url %}#{% endblock %}" class="navbar-brand">
          {% if school_info and school_info.logo_path %}
          <img
            src="{{ url_for('static', filename=school_info.logo_path) }}"
            alt="{{ school_info.school_name|default('School') }} Logo"
            onerror="this.src='{{ url_for('static', filename='images/default_logo.png') }}'"
          />
          {% else %}
          <img
            src="{{ url_for('static', filename='images/default_logo.png') }}"
            alt="School Logo"
          />
          {% endif %}
          <span>{{ school_info.school_name|default('Hillview School') }}</span>
        </a>
        <button type="button" class="navbar-toggle" id="mobileMenuToggle">
          <i class="fa fa-bars"></i>
        </button>
      </div>
    </nav>

    <!-- Mobile Navigation Overlay -->
    <div class="mobile-nav-overlay" id="mobileNavOverlay"></div>

    <!-- Mobile Navigation Menu -->
    <nav class="mobile-nav" id="mobileNav">
      <div class="mobile-nav-header">
        <span class="navbar-brand">
          <i class="fas fa-user-circle"></i>
          {{ session.get('username', 'User') }}
        </span>
        <button type="button" class="mobile-nav-close" id="mobileNavClose">
          <i class="fa fa-times"></i>
        </button>
      </div>
      <ul class="mobile-nav-menu">
        {% block navigation_items %}
        <li class="mobile-nav-item">
          <a href="#" class="mobile-nav-link">
            <i class="fas fa-home"></i>
            Dashboard
          </a>
        </li>
        {% endblock %}
      </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Page Header -->
      {% block page_header %}
      <div class="page-header">
        <h1 class="page-title">
          {% block header_title %}Page Title{% endblock %}
        </h1>
        <p class="page-subtitle">
          {% block header_subtitle %}Page description{% endblock %}
        </p>
      </div>
      {% endblock %}

      <!-- Flash Messages -->
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %}
      <div class="mobile-container">
        {% for category, message in messages %}
        <div
          class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show"
          role="alert"
        >
          <i
            class="fas fa-{{ 'check-circle' if category == 'success' else 'exclamation-triangle' if category == 'warning' else 'times-circle' if category == 'error' else 'info-circle' }}"
          ></i>
          {{ message }}
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="alert"
          ></button>
        </div>
        {% endfor %}
      </div>
      {% endif %} {% endwith %}

      <!-- Page Content -->
      <div class="mobile-container">
        {% block content %}
        <p>Content goes here</p>
        {% endblock %}
      </div>
    </main>

    <!-- Bootstrap JS (async loading for better performance) -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      async
    ></script>

    <!-- Mobile Navigation Script -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const mobileMenuToggle = document.getElementById("mobileMenuToggle");
        const mobileNav = document.getElementById("mobileNav");
        const mobileNavOverlay = document.getElementById("mobileNavOverlay");
        const mobileNavClose = document.getElementById("mobileNavClose");

        function openMobileNav() {
          mobileNav.classList.add("active");
          mobileNavOverlay.classList.add("active");
          document.body.style.overflow = "hidden";
        }

        function closeMobileNav() {
          mobileNav.classList.remove("active");
          mobileNavOverlay.classList.remove("active");
          document.body.style.overflow = "";
        }

        mobileMenuToggle.addEventListener("click", openMobileNav);
        mobileNavClose.addEventListener("click", closeMobileNav);
        mobileNavOverlay.addEventListener("click", closeMobileNav);

        // Close menu on escape key
        document.addEventListener("keydown", function (e) {
          if (e.key === "Escape" && mobileNav.classList.contains("active")) {
            closeMobileNav();
          }
        });

        // Handle window resize with debouncing for better performance
        let resizeTimeout;
        window.addEventListener("resize", function () {
          clearTimeout(resizeTimeout);
          resizeTimeout = setTimeout(function () {
            if (
              window.innerWidth > 768 &&
              mobileNav.classList.contains("active")
            ) {
              closeMobileNav();
            }
          }, 100);
        });

        // Optimize scroll performance
        let ticking = false;
        function updateScrollPosition() {
          // Add scroll-based optimizations here if needed
          ticking = false;
        }

        window.addEventListener("scroll", function () {
          if (!ticking) {
            requestAnimationFrame(updateScrollPosition);
            ticking = true;
          }
        });

        // Preload critical resources
        if ("requestIdleCallback" in window) {
          requestIdleCallback(function () {
            // Preload any additional resources during idle time
            const link = document.createElement("link");
            link.rel = "prefetch";
            link.href =
              '{{ url_for("static", filename="css/mobile_solar_theme.css") }}';
            document.head.appendChild(link);
          });
        }
      });
    </script>

    <!-- Page-specific JavaScript -->
    {% block extra_js %}{% endblock %}
  </body>
</html>
